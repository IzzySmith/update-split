<!DOCTYPE html>
<html lang="en">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <title>Share</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Custom CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/startbootstrap-stylish-portfolio/3.3.7/css/stylish-portfolio.css" rel="stylesheet">
    <link href="../static/popup_link.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../static/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

   <script type="text/javascript" src="../static/share.js" ></script> 

   <style>
   #exitButton {
  background-color: white;
  background-size: cover;
}
    
.mainText {
  color: white;
}
       
a {
  color: white;
}
 
</style>

</head>

<body style="background-image: url('../static/ride.jpg');">

    <header id="top" class="header">
        <div class="text-vertical-center">
            <!-- form to enter the email address of a friend -->
            <form action="/share" method="POST">
             <p>
             <label>
                 <h2 class="mainText">Share link!</h2>
                 <input id="inviteLink" type="text" name="inviteLink" placeholder="invite link"/>
             </label>
             </p>
             <p>
             <label>
                  <input id="copyLink" class="button" type="button" value="copy link"/>
             </p>
             </label>
             </p>
             <p>
	     <label>
                 <h2 class="mainText">Send link in Email</h2>
                 <input id="enterEmail" type="email" name="emailAddress" placeholder="enter email address"/>
              </label>
              </p>
              <p>
              <label>
                 <input type="submit" class="button" id="sendEmail" value="send email!"/>
              </label>
              </p>
            </form>
            <br>
        </div>
    </header>

    <script>
    var link;
var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
var eventer = window[eventMethod];
var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";
// Listen to message from child IFrame window
eventer(messageEvent, function (e) {
   var string = JSON.stringify(e.data);
   // check to see if the string contains the session id 
   if (string.match(/[0-9]{3}[-][0-9]{3}[-][0-9]{3}/g)) {
      link = string.substring(1, string.length - 1);
      document.getElementById("inviteLink").value = link;
   }
}, false);

</script>

<script>
var copyText = document.getElementById('copyLink');
copyText.addEventListener('click', function () {
   var copiedLink = document.getElementById('inviteLink');
   // select the contents
   inviteLink.select();
	   
   document.execCommand('copy');
}, false);

</script>
</body>
</html>
